<!DOCTYPE html>
<html>
<head>
<style>
body {
  background-color: black;
}

canvas {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}

</style>
</head>

<body>
<div>
<canvas id="canvas" width=640 height=480 class="canvas"></canvas>
</div>

<script>

    var bl = {x:-1, y:-1, z:5}
    var br = {x:1, y:-1, z:5}
    var tl = {x:-1, y:1, z:5}
    var tr = {x:1, y:1, z:5}

    var blz = {x:-1, y:-1, z:7}
    var brz = {x:1, y:-1, z:7}
    var tlz = {x:-1, y:1, z:7}
    var trz = {x:1, y:1, z:7}

function worldToScreen(p) {
    let factor = 640
    var screen = {x: p.x / p.z * factor + 320, y: p.y / p.z * factor + 240}
    return screen
}

function rotateZ(p) {
  var angle = 0.0174444
  var point = {x: p.x*Math.cos(angle) - p.y*Math.sin(angle), y:p.y*Math.cos(angle) + p.x*Math.sin(angle), z: p.z}
  return point;
}

function rotateX(p) {
    var angle = 0.0174444
    var z = p.z - 6
    var y = p.y*Math.cos(angle) - z*Math.sin(angle)
    var zz = (p.y*Math.sin(angle) + z*Math.cos(angle)) + 6
    var point = {x: p.x, y: y, z: zz}
    return point
}

function rotateY(p) {
    var angle = 0.0174444
    var z = p.z - 6
    var x = p.x*Math.cos(angle) + z*Math.sin(angle)
    var zz = (-p.x*Math.sin(angle) + z*Math.cos(angle)) + 6
    var point = {x: x, y: p.y, z: zz}
    return point
}

function drawPixel(point) {
     context.fillStyle = "#FFFF"
     context.fillRect(point.x, point.y, 1, 1)
   }


function drawLine(p0, p1) {
    var x0 = parseInt(p0.x)
    var x1 = parseInt(p1.x)

    var y0 = parseInt(p0.y)
    var y1 = parseInt(p1.y)

    var dx = Math.abs(x1 - x0)
    var dy = Math.abs(y1 - y0)
    var sx = (x0 < x1) ? 1 : -1
    var sy = (y0 < y1) ? 1 : -1
    var err = dx - dy

    while (x0!=x1 || y0!=y1) {
       if (x0 >= 0 &&
           y0 >= 0 &&
           x0 < 640 &&
           y0 < 480) {
           var p = {x: x0, y: y0}
           drawPixel(p)
       }

       var e2 = 2 * err
       if (e2 > -dy) {
        err -= dy
        x0 += sx
       }

       if (e2 < dx) {
        err += dx
        y0 += sy
       }
    }
}

   function update() {
     context.fillStyle = "#000";
     context.fillRect(0, 0, 640, 480);
     
     bl = rotateZ(bl)
     br = rotateZ(br)
     tl = rotateZ(tl)
     tr = rotateZ(tr)
     blz = rotateZ(blz)
     brz = rotateZ(brz)
     tlz = rotateZ(tlz)
     trz = rotateZ(trz)

    bl = rotateX(bl)
    br = rotateX(br)
    tl = rotateX(tl)
    tr = rotateX(tr)
    blz = rotateX(blz)
    brz = rotateX(brz)
    tlz = rotateX(tlz)
    trz = rotateX(trz)

    bl = rotateY(bl)
    br = rotateY(br)
    tl = rotateY(tl)
    tr = rotateY(tr)
    blz = rotateY(blz)
    brz = rotateY(brz)
    tlz = rotateY(tlz)
    trz = rotateY(trz)

     var blr = worldToScreen(bl)
     var brr = worldToScreen(br)
     var tlr = worldToScreen(tl)
     var trr = worldToScreen(tr)

    var blrz = worldToScreen(blz)
    var brrz = worldToScreen(brz)
    var tlrz = worldToScreen(tlz)
    var trrz = worldToScreen(trz)
     
     drawPixel(blr)
     drawPixel(brr)
     drawPixel(tlr)
     drawPixel(trr)

    drawPixel(blrz)
    drawPixel(brrz)
    drawPixel(tlrz)
    drawPixel(trrz)

    // frontmost square
    drawLine(blr, brr)
    drawLine(blr, tlr)
    drawLine(tlr, trr)
    drawLine(brr, trr)

    // z square
    drawLine(blrz, brrz)
    drawLine(blrz, tlrz)
    drawLine(tlrz, trrz)
    drawLine(brrz, trrz)

    // connect the squares
    drawLine(blr, blrz)
    drawLine(brr, brrz)
    drawLine(tlr, tlrz)
    drawLine(trr, trrz)
   }
  
    var canvas = document.getElementById("canvas");
    var context = canvas.getContext("2d");

    setInterval(update, 33)
</script>

</body>
</html>
